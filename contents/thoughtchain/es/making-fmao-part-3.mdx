---
title: "Escribiendo En lo múltiple, como uno — Parte 3: Construyendo un registro Lit3"
description: "En este artículo, abordamos el propósito y la estructura del Archivo del Plexo — el componente web3 que acompaña a Desde el Plexo."
date: 26-09-2025
authors:
  - avatar: "/images/LokapalMain.png"
    handle: lokapalxyz
    username: lokapal.eth
    handleUrl: "https://x.com/lokapalxyz"
cover: "/images/making-fmao.jpg"
---

## Introducción

En la Parte 2, nos enfrentamos a un desafío inesperado: *Desde el Plexo* necesitaba un componente web3 apropiado para pertenecer verdaderamente al espacio Lit3. Ese desafío dio origen al Archivo del Plexo — un contenedor narrativo que amplió nuestras micro-historias sin interrumpir su flujo.

Pero crear el *concepto* de un Archivo fue la parte fácil. ¿La parte difícil? Construirlo realmente.

Este artículo documenta el viaje técnico de implementar nuestro primer registro Lit3: las decisiones que tomamos, los problemas que encontramos y lo que aprendimos sobre tender puentes entre la intención narrativa y la infraestructura blockchain.

---

## La pregunta de diseño

Antes de escribir una sola línea de código, enfrentamos una pregunta fundamental: **¿Cómo hacemos que los datos blockchain se sientan como parte de la historia, no como un apéndice técnico?**

La respuesta requería pensar el Archivo del Plexo desde dos perspectivas simultáneamente:

**Perspectiva Narrativa**: El Archivo es un lugar místico donde el Archivista almacena transmisiones interceptadas desde Lanka Prime. Existe fuera del espacio-tiempo normal, accesible solo por medios especiales.

**Perspectiva Técnica**: El Archivo es un contrato inteligente en Base Mainnet que almacena permanentemente metadatos sobre cada esquirla de la historia. Debe ser consultable, verificable y propiedad de una billetera designada.

Estas perspectivas necesitaban reforzarse mutuamente. La implementación técnica no podía solo *apoyar* la narrativa — tenía que *encarnarla*.

---

## Contrato inteligente como herramienta narrativa

Nuestro contrato inteligente, `PlexusArchive.sol`, hace algo astutamente simple: almacena cinco piezas de metadatos para cada esquirla.

```solidity
struct Shard {
    string shardTag;        // La etiqueta del Archivista
    string echoSource;      // De dónde se originó la transmisión
    string earthTime;       // Cuándo la interceptamos (UTC)
    string lankaTime;       // Cuándo ocurrió en Lanka Prime
    string archivistLog;    // Las observaciones del Archivista
}
```

Pero la forma en que almacena estos datos importa enormemente:

**Control de Acceso**: Solo una billetera — la del Archivista — puede archivar nuevas esquirlas. Esto no es solo por seguridad; es canon. El Archivista es una entidad singular en nuestro lore. Una billetera = un ser.

**Inmutabilidad**: Una vez archivados, los fragmentos no pueden ser editados o eliminados. Lo que el Archivista registra se convierte en verdad permanente. Esto refleja la función narrativa del Archivo como el registro autoritativo de transmisiones.

**Emisión de Eventos**: Cada acción de archivo emite el evento `ShardArchived` que contiene todos los metadatos. Estos eventos se convierten en la base para consultas — pero más sobre eso en la Parte 4 de *Escribiendo En lo múltiple, como uno*.

**Indexación Permanente**: Cada esquirla obtiene un índice secuencial y registra el número de bloque al momento del archivado. La Huella Akáshica se convirtió en nuestro término para esto — un guiño al concepto de los registros akáshicos, que los teósofos creen están codificados en un plano no físico de existencia conocido como el plano mental.

Las decisiones técnicas refuerzan la construcción del mundo narrativo. No estamos solo almacenando datos; estamos inscribiendo transmisiones en un archivo místico.

---

## Haciendo el despliegue accesible

**Nota**: El código del *Archivo del Plexo* está por completo en **código abierto**, licenciado bajo Licencia MIT, y fácilmente accesible en nuestro [**repositorio de Github**](https://github.com/lokapal-xyz/archivo-del-plexo). Siéntete libre de clonarlo y modificarlo.

Aquí hay algo que aprendimos arduamente: la mayoría de los escritores no van a aprender Solidity, compilar contratos y desplegarlos manualmente en redes blockchain. Si Lit3 va a ser un movimiento, la barrera técnica necesita ser dramáticamente más baja.

Nuestra solución fue construir scripts de despliegue que manejan la complejidad detrás de comandos simples. Nuestro script actual permite al usuario desplegar en Base Sepolia o Base Mainnet. Pero como el repositorio es **de código abierto**, puede ser modificado para acceder a cualquier otra red EVM:

```bash
./deploy-archive.sh base-sepolia
```

Ese único comando:
1. Compila el contrato inteligente
2. Lo despliega en la red de prueba Base Sepolia
3. Verifica el código fuente en BaseScan
4. Guarda la dirección del contrato en archivos de configuración
5. Proporciona enlaces directos para ver el contrato

Pero esto es lo que hace que este enfoque sea útil para otros proyectos Lit3: **los scripts pueden ser interpretados por personas que no son desarrolladores profesionales**. Abre `deploy-archive.sh` y verás comandos bash simples con comentarios explicando qué hace cada sección. Un escritor habituado a los comandos de terminal puede modificar estos scripts para sus propios proyectos sin entender los detalles internos de Solidity.

Hicimos scripts similares para archivar esquirlas:

```bash
./archive-shard.sh base-sepolia \
  "Encender un cigarro" \
  "Red ferroviaria de la Bolsa de Lobha" \
  "2025-09-28 14:47:53 UTC" \
  "Varsam 7E9, Dinam 10F, Kala 455" \
  "El honor no es propio de un necio"
```

El script solicita confirmación, muestra estimaciones de gas y proporciona enlaces de transacción. Hace que la interacción blockchain se sienta más como publicar una entrada de blog que ejecutar funciones de contratos inteligentes.

---

## El problema de permisos de archivos

Foundry (nuestro framework de contratos inteligentes) ejecuta scripts en un entorno aislado donde las operaciones de archivos pueden causar reversiones de transacciones. Si intentas escribir datos de despliegue en disco *durante* la transacción de despliegue, los nodos blockchain lo rechazan justificadamente.

La solución fue separar las responsabilidades: el script de Solidity maneja las operaciones blockchain; los scripts bash manejan las operaciones de archivos. No es elegante, pero es pragmático. Esto muestra una lección importante: **trabajar con blockchain requiere aceptar sus restricciones en lugar de luchar contra ellas**.

Esto es relevante para proyectos Lit3 porque es un patrón que encontrarás repetidamente: el blockchain hace ciertas cosas excepcionalmente bien (almacenamiento inmutable, verificación, propiedad) y otras cosas menos bien (I/O de archivos, computación compleja, estado mutable). Diseña tu sistema alrededor de las fortalezas del blockchain, y maneja todo lo demás fuera de la cadena.

---

## Lo que esta arquitectura permite

Con nuestro contrato inteligente desplegado y scripts escritos, ahora podemos:

**Archivar esquirlas permanentes**: Cada micro-historia de *Desde el Plexo* se registra en Base Mainnet con sus metadatos. Este registro no puede ser alterado, no puede ser eliminado, y persistirá mientras Base exista.

**Probar autenticidad**: Cualquiera puede verificar que una esquirla etiquetada como "oficial" realmente provino de la billetera del Archivista. No se necesita autoridad central.

**Construir sobre los fundamentos**: Otros desarrolladores podrían potencialmente consultar nuestro Archivo y construir herramientas, visualizaciones, o incluso historias derivadas usando nuestros datos canónicos.

**Mantener coherencia narrativa**: Como solo una billetera puede archivar, no hay ambigüedad sobre qué es canon. La palabra del Archivista es ley — tanto técnica como narrativamente.

Pero esto es lo que *no* podíamos hacer todavía: hacer que estos datos fueran fácilmente accesibles para los lectores. El Archivo existía, pero era como un libro encerrado en una bóveda. Podías verificar que estaba ahí, pero no podías leerlo sin conocimiento técnico significativo.

En la siguiente parte detallaremos este desafío.

---

## Lecciones aprendidas

**Comienza con la implementación más simple posible**: Nuestro primer borrador del contrato tenía características complejas que pensamos que necesitaríamos. Cortamos el 60% de ellas. Comienza simple, agrega complejidad solo cuando sea necesario.

**Los costos de gas importan menos en L2s**: Base (una Capa 2 de Ethereum) tiene transacciones baratas. No sobre-optimices el uso de gas a expensas de la claridad del código.

**Escribe para tu yo futuro**: En seis meses, puede que necesites modificar este contrato. Escribe comentarios explicando *por qué* tomaste decisiones de diseño, no solo qué hace el código.

**Primero testnet, siempre**: Desplegamos en Base Sepolia múltiples veces, capturamos bugs, refinamos nuestro proceso. Nunca experimentes en mainnet.

**El desarrollo blockchain es más lento de lo que piensas**: Incluso los contratos simples requieren pruebas extensas, scripts de despliegue y procesos de verificación. Planifica en consecuencia.

---

## Qué sigue

El Archivo del Plexo ahora existe en cadena, almacenando permanentemente los metadatos de nuestra historia. Pero los datos blockchain no están diseñados para consumo humano — están optimizados para consenso y verificación.

En la Parte 4, exploraremos cómo hicimos el Archivo *consultable*: usando The Graph Protocol para indexar los eventos de nuestro contrato inteligente y exponerlos a través de una API GraphQL. Aquí es donde la infraestructura técnica comienza a volverse invisible, y los lectores finalmente pueden interactuar con el Archivo sin necesidad de entender cómo funciona.

El objetivo no es solo hacer los datos blockchain accesibles — es hacer que se sientan como una extensión natural de la experiencia de lectura.

<Image
  src="/images/banner-purple.png"
  alt=""
  width={1580}
  height={140}
/>

**Gracias por leer — nos vemos en Lanka Prime.**